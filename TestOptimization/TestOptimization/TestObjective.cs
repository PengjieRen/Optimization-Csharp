using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Optimization.Objective;
using Optimization.Utils;
using Optimization.Projection;

namespace TestOptimization
{
    /**
     * 
     * 多项式回归
     * 
     **/
    public class TestIDifferentiableBaseObjective:AbstractDifferentiableBaseObjective
    {
        double[] data = new double[] { 4.5, 7.699999999999999, 17.5, 33.9, 56.9, 86.5, 122.69999999999999, 165.5, 214.9, 270.9, 333.49999999999994, 402.7, 478.49999999999994, 560.9, 649.9, 745.5, 847.6999999999999, 956.5, 1071.8999999999999, 1193.9, 1322.5, 1457.6999999999998, 1599.4999999999998, 1747.8999999999999, 1902.9, 2064.4999999999995, 2232.7, 2407.5, 2588.8999999999996, 2776.9, 2971.4999999999995, 3172.7, 3380.5, 3594.8999999999996, 3815.9, 4043.5, 4277.7, 4518.5, 4765.900000000001, 5019.9, 5280.499999999999, 5547.7, 5821.5, 6101.9, 6388.9, 6682.499999999999, 6982.7, 7289.5, 7602.9, 7922.9, 8249.5, 8582.699999999999, 8922.499999999998, 9268.9, 9621.9, 9981.5, 10347.699999999999, 10720.499999999998, 11099.9, 11485.9, 11878.5, 12277.699999999999, 12683.499999999998, 13095.9, 13514.9, 13940.5, 14372.699999999999, 14811.499999999998, 15256.9, 15708.9, 16167.5, 16632.7, 17104.5, 17582.899999999998, 18067.9, 18559.5, 19057.7, 19562.5, 20073.899999999998, 20591.9, 21116.5, 21647.699999999997, 22185.499999999996, 22729.899999999998, 23280.9, 23838.5, 24402.699999999997, 24973.499999999996, 25550.899999999998, 26134.9, 26725.5, 27322.699999999997, 27926.499999999996, 28536.899999999998, 29153.9, 29777.5, 30407.699999999997, 31044.499999999996, 31687.899999999998, 32337.9, 32994.49999999999, 33657.7, 34327.5, 35003.899999999994, 35686.9, 36376.49999999999, 37072.7, 37775.5, 38484.899999999994, 39200.9, 39923.49999999999, 40652.7, 41388.5, 42130.899999999994, 42879.9, 43635.49999999999, 44397.7, 45166.5, 45941.899999999994, 46723.9, 47512.49999999999, 48307.7, 49109.5, 49917.899999999994, 50732.9, 51554.49999999999, 52382.7, 53217.5, 54058.899999999994, 54906.9, 55761.49999999999, 56622.7, 57490.5, 58364.899999999994, 59245.9, 60133.49999999999, 61027.7, 61928.5, 62835.899999999994, 63749.9, 64670.5, 65597.7, 66531.5, 67471.90000000001, 68418.9, 69372.5, 70332.7, 71299.5, 72272.90000000001, 73252.9, 74239.5, 75232.7, 76232.5, 77238.90000000001, 78251.9, 79271.5, 80297.7, 81330.5, 82369.9, 83415.9, 84468.49999999999, 85527.7, 86593.5, 87665.9, 88744.9, 89830.49999999999, 90922.7, 92021.5, 93126.9, 94238.9, 95357.49999999999, 96482.7, 97614.5, 98752.9, 99897.9, 101049.49999999999, 102207.7, 103372.5, 104543.9, 105721.9, 106906.49999999999, 108097.7, 109295.5, 110499.9, 111710.9, 112928.49999999999, 114152.7, 115383.5, 116620.9, 117864.9, 119115.49999999999, 120372.7, 121636.5, 122906.9, 124183.9, 125467.49999999999, 126757.7, 128054.5, 129357.9, 130667.9, 131984.5, 133307.69999999998, 134637.49999999997, 135973.9, 137316.9, 138666.5, 140022.69999999998, 141385.49999999997, 142754.9, 144130.9, 145513.5, 146902.69999999998, 148298.49999999997, 149700.9, 151109.9, 152525.5, 153947.69999999998, 155376.49999999997, 156811.9, 158253.9, 159702.5, 161157.69999999998, 162619.49999999997, 164087.9, 165562.9, 167044.5, 168532.69999999998, 170027.49999999997, 171528.9, 173036.9, 174551.5, 176072.69999999998, 177600.49999999997, 179134.9, 180675.9, 182223.5, 183777.69999999998, 185338.49999999997, 186905.9, 188479.9, 190060.5, 191647.69999999998, 193241.49999999997, 194841.9, 196448.9, 198062.5, 199682.69999999998, 201309.49999999997, 202942.9, 204582.9, 206229.5, 207882.69999999998, 209542.49999999997, 211208.9, 212881.9, 214561.5, 216247.69999999998, 217940.49999999997, 219639.9, 221345.9, 223058.5, 224777.69999999998, 226503.49999999997, 228235.9, 229974.9, 231720.5, 233472.69999999998, 235231.49999999997, 236996.9, 238768.9, 240547.5, 242332.69999999998, 244124.49999999997, 245922.9, 247727.9, 249539.5, 251357.69999999998, 253182.49999999997, 255013.9, 256851.9, 258696.5, 260547.7, 262405.5, 264269.89999999997, 266140.9, 268018.5, 269902.7, 271793.5, 273690.89999999997, 275594.9, 277505.5, 279422.7, 281346.5, 283276.89999999997, 285213.9, 287157.5, 289107.7, 291064.5, 293027.89999999997, 294997.9, 296974.5, 298957.7, 300947.5, 302943.89999999997, 304946.9, 306956.5, 308972.7, 310995.5, 313024.89999999997, 315060.9, 317103.5, 319152.7, 321208.5, 323270.89999999997, 325339.9, 327415.5, 329497.69999999995, 331586.49999999994, 333681.89999999997, 335783.9, 337892.5, 340007.69999999995, 342129.49999999994, 344257.89999999997, 346392.9, 348534.5, 350682.69999999995, 352837.49999999994, 354998.89999999997, 357166.9, 359341.5, 361522.69999999995, 363710.49999999994, 365904.89999999997, 368105.9, 370313.5, 372527.69999999995, 374748.49999999994, 376975.89999999997, 379209.9, 381450.5, 383697.69999999995, 385951.49999999994, 388211.89999999997, 390478.9, 392752.5, 395032.69999999995, 397319.49999999994, 399612.89999999997, 401912.9, 404219.5, 406532.69999999995, 408852.49999999994, 411178.89999999997, 413511.9, 415851.5, 418197.69999999995, 420550.49999999994, 422909.89999999997, 425275.9, 427648.5, 430027.69999999995, 432413.49999999994, 434805.89999999997, 437204.9, 439610.5, 442022.69999999995, 444441.49999999994, 446866.89999999997, 449298.9, 451737.5, 454182.69999999995, 456634.49999999994, 459092.89999999997, 461557.9, 464029.5, 466507.69999999995, 468992.49999999994, 471483.89999999997, 473981.9, 476486.5, 478997.69999999995, 481515.49999999994, 484039.89999999997, 486570.9, 489108.5, 491652.69999999995, 494203.49999999994, 496760.89999999997, 499324.9, 501895.5, 504472.69999999995, 507056.49999999994, 509646.89999999997, 512243.9, 514847.5, 517457.69999999995, 520074.49999999994, 522697.8999999999, 525327.9, 527964.4999999999, 530607.7, 533257.5, 535913.8999999999, 538576.9, 541246.4999999999, 543922.7, 546605.5, 549294.8999999999, 551990.9, 554693.4999999999, 557402.7, 560118.5, 562840.8999999999, 565569.9, 568305.4999999999, 571047.7, 573796.5, 576551.8999999999, 579313.9, 582082.4999999999, 584857.7, 587639.5, 590427.8999999999, 593222.9, 596024.4999999999, 598832.7, 601647.5, 604468.8999999999, 607296.9, 610131.4999999999, 612972.7, 615820.5, 618674.8999999999, 621535.9, 624403.4999999999, 627277.7, 630158.5, 633045.8999999999, 635939.9, 638840.4999999999, 641747.7, 644661.5, 647581.8999999999, 650508.9, 653442.4999999999, 656382.7, 659329.5, 662282.8999999999, 665242.9, 668209.4999999999, 671182.7, 674162.5, 677148.8999999999, 680141.9, 683141.4999999999, 686147.7, 689160.5, 692179.8999999999, 695205.9, 698238.4999999999, 701277.7, 704323.5, 707375.8999999999, 710434.9, 713500.4999999999, 716572.7, 719651.5, 722736.8999999999, 725828.9, 728927.4999999999, 732032.7, 735144.5, 738262.8999999999, 741387.9, 744519.4999999999, 747657.7, 750802.5, 753953.8999999999, 757111.9, 760276.4999999999, 763447.7, 766625.5, 769809.8999999999, 773000.9, 776198.4999999999, 779402.7, 782613.5, 785830.8999999999, 789054.9, 792285.4999999999, 795522.7, 798766.5, 802016.8999999999, 805273.9, 808537.4999999999, 811807.7, 815084.5, 818367.8999999999, 821657.9, 824954.4999999999, 828257.7, 831567.5, 834883.8999999999, 838206.9, 841536.4999999999, 844872.7, 848215.5, 851564.8999999999, 854920.9, 858283.4999999999, 861652.7, 865028.5, 868410.8999999999, 871799.9, 875195.4999999999, 878597.7, 882006.5, 885421.8999999999, 888843.9, 892272.4999999999, 895707.7, 899149.5, 902597.8999999999, 906052.9, 909514.4999999999, 912982.7, 916457.5, 919938.8999999999, 923426.9, 926921.4999999999, 930422.7, 933930.5, 937444.8999999999, 940965.9, 944493.4999999999, 948027.7, 951568.5, 955115.8999999999, 958669.9, 962230.4999999999, 965797.7, 969371.5, 972951.8999999999, 976538.9, 980132.4999999999, 983732.7, 987339.5, 990952.8999999999, 994572.9, 998199.4999999999, 1001832.7, 1005472.5, 1009118.8999999999, 1012771.9, 1016431.4999999999, 1020097.7, 1023770.5, 1027449.8999999999, 1031135.9, 1034828.4999999999, 1038527.7, 1042233.5, 1045945.9, 1049664.9, 1053390.5, 1057122.7, 1060861.5, 1064606.9000000001, 1068358.9, 1072117.5, 1075882.7, 1079654.5, 1083432.9000000001, 1087217.9, 1091009.5, 1094807.7, 1098612.5, 1102423.9000000001, 1106241.9, 1110066.5, 1113897.7, 1117735.5, 1121579.9000000001, 1125430.9, 1129288.5, 1133152.7, 1137023.5, 1140900.9000000001, 1144784.9, 1148675.5, 1152572.7, 1156476.5, 1160386.9000000001, 1164303.9, 1168227.5, 1172157.7, 1176094.5, 1180037.9000000001, 1183987.9, 1187944.5, 1191907.7, 1195877.5, 1199853.9000000001, 1203836.9, 1207826.5, 1211822.7, 1215825.5, 1219834.9000000001, 1223850.9, 1227873.5, 1231902.7, 1235938.5, 1239980.9000000001, 1244029.9, 1248085.5, 1252147.7, 1256216.5, 1260291.9000000001, 1264373.9, 1268462.5, 1272557.7, 1276659.5, 1280767.9000000001, 1284882.9, 1289004.5, 1293132.7, 1297267.5, 1301408.9, 1305556.9, 1309711.4999999998, 1313872.7, 1318040.5, 1322214.9, 1326395.9, 1330583.4999999998, 1334777.7, 1338978.5, 1343185.9, 1347399.9, 1351620.4999999998, 1355847.7, 1360081.5, 1364321.9, 1368568.9, 1372822.4999999998, 1377082.7, 1381349.5, 1385622.9, 1389902.9, 1394189.4999999998, 1398482.7, 1402782.5, 1407088.9, 1411401.9, 1415721.4999999998, 1420047.7, 1424380.5, 1428719.9, 1433065.9, 1437418.4999999998, 1441777.7, 1446143.5, 1450515.9, 1454894.9, 1459280.4999999998, 1463672.7, 1468071.5, 1472476.9, 1476888.9, 1481307.4999999998, 1485732.7, 1490164.5, 1494602.9, 1499047.9, 1503499.4999999998, 1507957.7, 1512422.5, 1516893.9, 1521371.9, 1525856.4999999998, 1530347.7, 1534845.5, 1539349.9, 1543860.9, 1548378.4999999998, 1552902.7, 1557433.5, 1561970.9, 1566514.9, 1571065.4999999998, 1575622.7, 1580186.5, 1584756.9, 1589333.9, 1593917.4999999998, 1598507.7, 1603104.5, 1607707.9, 1612317.9, 1616934.4999999998, 1621557.7, 1626187.5, 1630823.9, 1635466.9, 1640116.4999999998, 1644772.7, 1649435.5, 1654104.9, 1658780.9, 1663463.4999999998, 1668152.7, 1672848.5, 1677550.9, 1682259.9, 1686975.4999999998, 1691697.7, 1696426.5, 1701161.9, 1705903.9, 1710652.4999999998, 1715407.7, 1720169.5, 1724937.9, 1729712.9, 1734494.4999999998, 1739282.7, 1744077.5, 1748878.9, 1753686.9, 1758501.4999999998, 1763322.7, 1768150.5, 1772984.9, 1777825.9, 1782673.4999999998, 1787527.7, 1792388.5, 1797255.9, 1802129.9, 1807010.4999999998, 1811897.7, 1816791.5, 1821691.9, 1826598.9, 1831512.4999999998, 1836432.7, 1841359.5, 1846292.9, 1851232.9, 1856179.4999999998, 1861132.7, 1866092.5, 1871058.9, 1876031.9, 1881011.4999999998, 1885997.7, 1890990.5, 1895989.9, 1900995.9, 1906008.4999999998, 1911027.7, 1916053.5, 1921085.9, 1926124.9, 1931170.4999999998, 1936222.7, 1941281.5, 1946346.9, 1951418.9, 1956497.4999999998, 1961582.7, 1966674.5, 1971772.9, 1976877.9, 1981989.4999999998, 1987107.7, 1992232.5, 1997363.9, 2002501.9, 2007646.4999999998, 2012797.7, 2017955.5, 2023119.9, 2028290.9, 2033468.4999999998, 2038652.7, 2043843.5, 2049040.9, 2054244.9, 2059455.4999999998, 2064672.7, 2069896.5, 2075126.9, 2080363.9, 2085607.4999999998, 2090857.7, 2096114.4999999998, 2101377.9, 2106647.9, 2111924.5, 2117207.6999999997, 2122497.4999999995, 2127793.9, 2133096.9, 2138406.5, 2143722.6999999997, 2149045.4999999995, 2154374.9, 2159710.9, 2165053.5, 2170402.6999999997, 2175758.4999999995, 2181120.9, 2186489.9, 2191865.5, 2197247.6999999997, 2202636.4999999995, 2208031.9, 2213433.9, 2218842.5, 2224257.6999999997, 2229679.4999999995, 2235107.9, 2240542.9, 2245984.5, 2251432.6999999997, 2256887.4999999995, 2262348.9, 2267816.9, 2273291.5, 2278772.6999999997, 2284260.4999999995, 2289754.9, 2295255.9, 2300763.5, 2306277.6999999997, 2311798.4999999995, 2317325.9, 2322859.9, 2328400.5, 2333947.6999999997, 2339501.4999999995, 2345061.9, 2350628.9, 2356202.5, 2361782.6999999997, 2367369.4999999995, 2372962.9, 2378562.9, 2384169.5, 2389782.6999999997, 2395402.4999999995, 2401028.9, 2406661.9, 2412301.5, 2417947.6999999997, 2423600.4999999995, 2429259.9, 2434925.9, 2440598.5, 2446277.6999999997, 2451963.4999999995, 2457655.9, 2463354.9, 2469060.5, 2474772.6999999997, 2480491.4999999995, 2486216.9, 2491948.9, 2497687.5, 2503432.6999999997, 2509184.4999999995, 2514942.9, 2520707.9, 2526479.5, 2532257.6999999997, 2538042.4999999995, 2543833.9, 2549631.9, 2555436.5, 2561247.6999999997, 2567065.4999999995, 2572889.9, 2578720.9, 2584558.5, 2590402.6999999997, 2596253.4999999995, 2602110.9, 2607974.9, 2613845.5, 2619722.6999999997, 2625606.4999999995, 2631496.9, 2637393.9, 2643297.5, 2649207.6999999997, 2655124.4999999995, 2661047.9, 2666977.9, 2672914.5, 2678857.6999999997, 2684807.4999999995, 2690763.9, 2696726.9, 2702696.5, 2708672.6999999997, 2714655.4999999995, 2720644.9, 2726640.9, 2732643.5, 2738652.6999999997, 2744668.4999999995, 2750690.9, 2756719.9, 2762755.5, 2768797.6999999997, 2774846.4999999995, 2780901.9, 2786963.9, 2793032.5, 2799107.6999999997, 2805189.4999999995, 2811277.9, 2817372.9, 2823474.5, 2829582.6999999997, 2835697.4999999995, 2841818.9, 2847946.9, 2854081.5, 2860222.6999999997, 2866370.4999999995, 2872524.9, 2878685.9, 2884853.5, 2891027.6999999997, 2897208.4999999995, 2903395.9, 2909589.9, 2915790.5, 2921997.6999999997, 2928211.4999999995, 2934431.9, 2940658.9, 2946892.5, 2953132.6999999997, 2959379.4999999995, 2965632.9, 2971892.9, 2978159.5, 2984432.6999999997, 2990712.4999999995, 2996998.9, 3003291.9, 3009591.5, 3015897.6999999997, 3022210.4999999995, 3028529.9, 3034855.9, 3041188.5, 3047527.6999999997, 3053873.4999999995, 3060225.9, 3066584.9, 3072950.5, 3079322.6999999997, 3085701.4999999995, 3092086.9, 3098478.9, 3104877.5, 3111282.6999999997, 3117694.4999999995, 3124112.9, 3130537.9, 3136969.5, 3143407.6999999997, 3149852.4999999995, 3156303.9, 3162761.9, 3169226.5, 3175697.6999999997, 3182175.4999999995, 3188659.9, 3195150.9, 3201648.5, 3208152.6999999997, 3214663.4999999995, 3221180.9, 3227704.9, 3234235.5, 3240772.6999999997, 3247316.4999999995, 3253866.9, 3260423.9, 3266987.5, 3273557.6999999997, 3280134.4999999995, 3286717.9, 3293307.9 };


        public TestIDifferentiableBaseObjective(int DebugLevel):base(DebugLevel)
        {
        }

        public override double[] InitParameters()
        {
            Random r = new Random();
            double[] parameters = new double[3];
            parameters[0] = r.Next(100);
            parameters[1] = r.Next(100);
            parameters[2] = r.Next(100);
            return parameters;
        }

        public override double ValueAt(double[] parameters) {
            double value = 0;

            for (int i = 0; i < data.Length; i++)
            {
                double[] datapiece = new double[] { i + 1, data[i] };
                double tmp = parameters[0] + parameters[1] * datapiece[0] + parameters[2] * Math.Pow(datapiece[0], 2);
                value += 0.5 * Math.Pow(datapiece[1] - tmp, 2);
            }
            return value;
        }

        public override double[] GradientAt(double[] parameters)
        {

            double[] gradient=new double[parameters.Length];

            for (int i = 0; i < data.Length; i++)
            {
                double[] datapiece = new double[] { i + 1, data[i] };
                double tmp = parameters[0] + parameters[1] * datapiece[0] + parameters[2] * Math.Pow(datapiece[0], 2);
                gradient[0] += (tmp - datapiece[1]) * 1;
                gradient[1] += (tmp - datapiece[1]) * Math.Pow(datapiece[0], 1);
                gradient[2] += (tmp - datapiece[1]) * Math.Pow(datapiece[0], 2);
            }

            return gradient;
        }

    }


    /**
    * 
    * 多项式回归
    * 
    **/
    public class TestIProjectedDifferentiableBaseObjective : AbstractProjectedDifferentiableBaseObjective
    {
        double[] data = new double[] { 4.5, 7.699999999999999, 17.5, 33.9, 56.9, 86.5, 122.69999999999999, 165.5, 214.9, 270.9, 333.49999999999994, 402.7, 478.49999999999994, 560.9, 649.9, 745.5, 847.6999999999999, 956.5, 1071.8999999999999, 1193.9, 1322.5, 1457.6999999999998, 1599.4999999999998, 1747.8999999999999, 1902.9, 2064.4999999999995, 2232.7, 2407.5, 2588.8999999999996, 2776.9, 2971.4999999999995, 3172.7, 3380.5, 3594.8999999999996, 3815.9, 4043.5, 4277.7, 4518.5, 4765.900000000001, 5019.9, 5280.499999999999, 5547.7, 5821.5, 6101.9, 6388.9, 6682.499999999999, 6982.7, 7289.5, 7602.9, 7922.9, 8249.5, 8582.699999999999, 8922.499999999998, 9268.9, 9621.9, 9981.5, 10347.699999999999, 10720.499999999998, 11099.9, 11485.9, 11878.5, 12277.699999999999, 12683.499999999998, 13095.9, 13514.9, 13940.5, 14372.699999999999, 14811.499999999998, 15256.9, 15708.9, 16167.5, 16632.7, 17104.5, 17582.899999999998, 18067.9, 18559.5, 19057.7, 19562.5, 20073.899999999998, 20591.9, 21116.5, 21647.699999999997, 22185.499999999996, 22729.899999999998, 23280.9, 23838.5, 24402.699999999997, 24973.499999999996, 25550.899999999998, 26134.9, 26725.5, 27322.699999999997, 27926.499999999996, 28536.899999999998, 29153.9, 29777.5, 30407.699999999997, 31044.499999999996, 31687.899999999998, 32337.9, 32994.49999999999, 33657.7, 34327.5, 35003.899999999994, 35686.9, 36376.49999999999, 37072.7, 37775.5, 38484.899999999994, 39200.9, 39923.49999999999, 40652.7, 41388.5, 42130.899999999994, 42879.9, 43635.49999999999, 44397.7, 45166.5, 45941.899999999994, 46723.9, 47512.49999999999, 48307.7, 49109.5, 49917.899999999994, 50732.9, 51554.49999999999, 52382.7, 53217.5, 54058.899999999994, 54906.9, 55761.49999999999, 56622.7, 57490.5, 58364.899999999994, 59245.9, 60133.49999999999, 61027.7, 61928.5, 62835.899999999994, 63749.9, 64670.5, 65597.7, 66531.5, 67471.90000000001, 68418.9, 69372.5, 70332.7, 71299.5, 72272.90000000001, 73252.9, 74239.5, 75232.7, 76232.5, 77238.90000000001, 78251.9, 79271.5, 80297.7, 81330.5, 82369.9, 83415.9, 84468.49999999999, 85527.7, 86593.5, 87665.9, 88744.9, 89830.49999999999, 90922.7, 92021.5, 93126.9, 94238.9, 95357.49999999999, 96482.7, 97614.5, 98752.9, 99897.9, 101049.49999999999, 102207.7, 103372.5, 104543.9, 105721.9, 106906.49999999999, 108097.7, 109295.5, 110499.9, 111710.9, 112928.49999999999, 114152.7, 115383.5, 116620.9, 117864.9, 119115.49999999999, 120372.7, 121636.5, 122906.9, 124183.9, 125467.49999999999, 126757.7, 128054.5, 129357.9, 130667.9, 131984.5, 133307.69999999998, 134637.49999999997, 135973.9, 137316.9, 138666.5, 140022.69999999998, 141385.49999999997, 142754.9, 144130.9, 145513.5, 146902.69999999998, 148298.49999999997, 149700.9, 151109.9, 152525.5, 153947.69999999998, 155376.49999999997, 156811.9, 158253.9, 159702.5, 161157.69999999998, 162619.49999999997, 164087.9, 165562.9, 167044.5, 168532.69999999998, 170027.49999999997, 171528.9, 173036.9, 174551.5, 176072.69999999998, 177600.49999999997, 179134.9, 180675.9, 182223.5, 183777.69999999998, 185338.49999999997, 186905.9, 188479.9, 190060.5, 191647.69999999998, 193241.49999999997, 194841.9, 196448.9, 198062.5, 199682.69999999998, 201309.49999999997, 202942.9, 204582.9, 206229.5, 207882.69999999998, 209542.49999999997, 211208.9, 212881.9, 214561.5, 216247.69999999998, 217940.49999999997, 219639.9, 221345.9, 223058.5, 224777.69999999998, 226503.49999999997, 228235.9, 229974.9, 231720.5, 233472.69999999998, 235231.49999999997, 236996.9, 238768.9, 240547.5, 242332.69999999998, 244124.49999999997, 245922.9, 247727.9, 249539.5, 251357.69999999998, 253182.49999999997, 255013.9, 256851.9, 258696.5, 260547.7, 262405.5, 264269.89999999997, 266140.9, 268018.5, 269902.7, 271793.5, 273690.89999999997, 275594.9, 277505.5, 279422.7, 281346.5, 283276.89999999997, 285213.9, 287157.5, 289107.7, 291064.5, 293027.89999999997, 294997.9, 296974.5, 298957.7, 300947.5, 302943.89999999997, 304946.9, 306956.5, 308972.7, 310995.5, 313024.89999999997, 315060.9, 317103.5, 319152.7, 321208.5, 323270.89999999997, 325339.9, 327415.5, 329497.69999999995, 331586.49999999994, 333681.89999999997, 335783.9, 337892.5, 340007.69999999995, 342129.49999999994, 344257.89999999997, 346392.9, 348534.5, 350682.69999999995, 352837.49999999994, 354998.89999999997, 357166.9, 359341.5, 361522.69999999995, 363710.49999999994, 365904.89999999997, 368105.9, 370313.5, 372527.69999999995, 374748.49999999994, 376975.89999999997, 379209.9, 381450.5, 383697.69999999995, 385951.49999999994, 388211.89999999997, 390478.9, 392752.5, 395032.69999999995, 397319.49999999994, 399612.89999999997, 401912.9, 404219.5, 406532.69999999995, 408852.49999999994, 411178.89999999997, 413511.9, 415851.5, 418197.69999999995, 420550.49999999994, 422909.89999999997, 425275.9, 427648.5, 430027.69999999995, 432413.49999999994, 434805.89999999997, 437204.9, 439610.5, 442022.69999999995, 444441.49999999994, 446866.89999999997, 449298.9, 451737.5, 454182.69999999995, 456634.49999999994, 459092.89999999997, 461557.9, 464029.5, 466507.69999999995, 468992.49999999994, 471483.89999999997, 473981.9, 476486.5, 478997.69999999995, 481515.49999999994, 484039.89999999997, 486570.9, 489108.5, 491652.69999999995, 494203.49999999994, 496760.89999999997, 499324.9, 501895.5, 504472.69999999995, 507056.49999999994, 509646.89999999997, 512243.9, 514847.5, 517457.69999999995, 520074.49999999994, 522697.8999999999, 525327.9, 527964.4999999999, 530607.7, 533257.5, 535913.8999999999, 538576.9, 541246.4999999999, 543922.7, 546605.5, 549294.8999999999, 551990.9, 554693.4999999999, 557402.7, 560118.5, 562840.8999999999, 565569.9, 568305.4999999999, 571047.7, 573796.5, 576551.8999999999, 579313.9, 582082.4999999999, 584857.7, 587639.5, 590427.8999999999, 593222.9, 596024.4999999999, 598832.7, 601647.5, 604468.8999999999, 607296.9, 610131.4999999999, 612972.7, 615820.5, 618674.8999999999, 621535.9, 624403.4999999999, 627277.7, 630158.5, 633045.8999999999, 635939.9, 638840.4999999999, 641747.7, 644661.5, 647581.8999999999, 650508.9, 653442.4999999999, 656382.7, 659329.5, 662282.8999999999, 665242.9, 668209.4999999999, 671182.7, 674162.5, 677148.8999999999, 680141.9, 683141.4999999999, 686147.7, 689160.5, 692179.8999999999, 695205.9, 698238.4999999999, 701277.7, 704323.5, 707375.8999999999, 710434.9, 713500.4999999999, 716572.7, 719651.5, 722736.8999999999, 725828.9, 728927.4999999999, 732032.7, 735144.5, 738262.8999999999, 741387.9, 744519.4999999999, 747657.7, 750802.5, 753953.8999999999, 757111.9, 760276.4999999999, 763447.7, 766625.5, 769809.8999999999, 773000.9, 776198.4999999999, 779402.7, 782613.5, 785830.8999999999, 789054.9, 792285.4999999999, 795522.7, 798766.5, 802016.8999999999, 805273.9, 808537.4999999999, 811807.7, 815084.5, 818367.8999999999, 821657.9, 824954.4999999999, 828257.7, 831567.5, 834883.8999999999, 838206.9, 841536.4999999999, 844872.7, 848215.5, 851564.8999999999, 854920.9, 858283.4999999999, 861652.7, 865028.5, 868410.8999999999, 871799.9, 875195.4999999999, 878597.7, 882006.5, 885421.8999999999, 888843.9, 892272.4999999999, 895707.7, 899149.5, 902597.8999999999, 906052.9, 909514.4999999999, 912982.7, 916457.5, 919938.8999999999, 923426.9, 926921.4999999999, 930422.7, 933930.5, 937444.8999999999, 940965.9, 944493.4999999999, 948027.7, 951568.5, 955115.8999999999, 958669.9, 962230.4999999999, 965797.7, 969371.5, 972951.8999999999, 976538.9, 980132.4999999999, 983732.7, 987339.5, 990952.8999999999, 994572.9, 998199.4999999999, 1001832.7, 1005472.5, 1009118.8999999999, 1012771.9, 1016431.4999999999, 1020097.7, 1023770.5, 1027449.8999999999, 1031135.9, 1034828.4999999999, 1038527.7, 1042233.5, 1045945.9, 1049664.9, 1053390.5, 1057122.7, 1060861.5, 1064606.9000000001, 1068358.9, 1072117.5, 1075882.7, 1079654.5, 1083432.9000000001, 1087217.9, 1091009.5, 1094807.7, 1098612.5, 1102423.9000000001, 1106241.9, 1110066.5, 1113897.7, 1117735.5, 1121579.9000000001, 1125430.9, 1129288.5, 1133152.7, 1137023.5, 1140900.9000000001, 1144784.9, 1148675.5, 1152572.7, 1156476.5, 1160386.9000000001, 1164303.9, 1168227.5, 1172157.7, 1176094.5, 1180037.9000000001, 1183987.9, 1187944.5, 1191907.7, 1195877.5, 1199853.9000000001, 1203836.9, 1207826.5, 1211822.7, 1215825.5, 1219834.9000000001, 1223850.9, 1227873.5, 1231902.7, 1235938.5, 1239980.9000000001, 1244029.9, 1248085.5, 1252147.7, 1256216.5, 1260291.9000000001, 1264373.9, 1268462.5, 1272557.7, 1276659.5, 1280767.9000000001, 1284882.9, 1289004.5, 1293132.7, 1297267.5, 1301408.9, 1305556.9, 1309711.4999999998, 1313872.7, 1318040.5, 1322214.9, 1326395.9, 1330583.4999999998, 1334777.7, 1338978.5, 1343185.9, 1347399.9, 1351620.4999999998, 1355847.7, 1360081.5, 1364321.9, 1368568.9, 1372822.4999999998, 1377082.7, 1381349.5, 1385622.9, 1389902.9, 1394189.4999999998, 1398482.7, 1402782.5, 1407088.9, 1411401.9, 1415721.4999999998, 1420047.7, 1424380.5, 1428719.9, 1433065.9, 1437418.4999999998, 1441777.7, 1446143.5, 1450515.9, 1454894.9, 1459280.4999999998, 1463672.7, 1468071.5, 1472476.9, 1476888.9, 1481307.4999999998, 1485732.7, 1490164.5, 1494602.9, 1499047.9, 1503499.4999999998, 1507957.7, 1512422.5, 1516893.9, 1521371.9, 1525856.4999999998, 1530347.7, 1534845.5, 1539349.9, 1543860.9, 1548378.4999999998, 1552902.7, 1557433.5, 1561970.9, 1566514.9, 1571065.4999999998, 1575622.7, 1580186.5, 1584756.9, 1589333.9, 1593917.4999999998, 1598507.7, 1603104.5, 1607707.9, 1612317.9, 1616934.4999999998, 1621557.7, 1626187.5, 1630823.9, 1635466.9, 1640116.4999999998, 1644772.7, 1649435.5, 1654104.9, 1658780.9, 1663463.4999999998, 1668152.7, 1672848.5, 1677550.9, 1682259.9, 1686975.4999999998, 1691697.7, 1696426.5, 1701161.9, 1705903.9, 1710652.4999999998, 1715407.7, 1720169.5, 1724937.9, 1729712.9, 1734494.4999999998, 1739282.7, 1744077.5, 1748878.9, 1753686.9, 1758501.4999999998, 1763322.7, 1768150.5, 1772984.9, 1777825.9, 1782673.4999999998, 1787527.7, 1792388.5, 1797255.9, 1802129.9, 1807010.4999999998, 1811897.7, 1816791.5, 1821691.9, 1826598.9, 1831512.4999999998, 1836432.7, 1841359.5, 1846292.9, 1851232.9, 1856179.4999999998, 1861132.7, 1866092.5, 1871058.9, 1876031.9, 1881011.4999999998, 1885997.7, 1890990.5, 1895989.9, 1900995.9, 1906008.4999999998, 1911027.7, 1916053.5, 1921085.9, 1926124.9, 1931170.4999999998, 1936222.7, 1941281.5, 1946346.9, 1951418.9, 1956497.4999999998, 1961582.7, 1966674.5, 1971772.9, 1976877.9, 1981989.4999999998, 1987107.7, 1992232.5, 1997363.9, 2002501.9, 2007646.4999999998, 2012797.7, 2017955.5, 2023119.9, 2028290.9, 2033468.4999999998, 2038652.7, 2043843.5, 2049040.9, 2054244.9, 2059455.4999999998, 2064672.7, 2069896.5, 2075126.9, 2080363.9, 2085607.4999999998, 2090857.7, 2096114.4999999998, 2101377.9, 2106647.9, 2111924.5, 2117207.6999999997, 2122497.4999999995, 2127793.9, 2133096.9, 2138406.5, 2143722.6999999997, 2149045.4999999995, 2154374.9, 2159710.9, 2165053.5, 2170402.6999999997, 2175758.4999999995, 2181120.9, 2186489.9, 2191865.5, 2197247.6999999997, 2202636.4999999995, 2208031.9, 2213433.9, 2218842.5, 2224257.6999999997, 2229679.4999999995, 2235107.9, 2240542.9, 2245984.5, 2251432.6999999997, 2256887.4999999995, 2262348.9, 2267816.9, 2273291.5, 2278772.6999999997, 2284260.4999999995, 2289754.9, 2295255.9, 2300763.5, 2306277.6999999997, 2311798.4999999995, 2317325.9, 2322859.9, 2328400.5, 2333947.6999999997, 2339501.4999999995, 2345061.9, 2350628.9, 2356202.5, 2361782.6999999997, 2367369.4999999995, 2372962.9, 2378562.9, 2384169.5, 2389782.6999999997, 2395402.4999999995, 2401028.9, 2406661.9, 2412301.5, 2417947.6999999997, 2423600.4999999995, 2429259.9, 2434925.9, 2440598.5, 2446277.6999999997, 2451963.4999999995, 2457655.9, 2463354.9, 2469060.5, 2474772.6999999997, 2480491.4999999995, 2486216.9, 2491948.9, 2497687.5, 2503432.6999999997, 2509184.4999999995, 2514942.9, 2520707.9, 2526479.5, 2532257.6999999997, 2538042.4999999995, 2543833.9, 2549631.9, 2555436.5, 2561247.6999999997, 2567065.4999999995, 2572889.9, 2578720.9, 2584558.5, 2590402.6999999997, 2596253.4999999995, 2602110.9, 2607974.9, 2613845.5, 2619722.6999999997, 2625606.4999999995, 2631496.9, 2637393.9, 2643297.5, 2649207.6999999997, 2655124.4999999995, 2661047.9, 2666977.9, 2672914.5, 2678857.6999999997, 2684807.4999999995, 2690763.9, 2696726.9, 2702696.5, 2708672.6999999997, 2714655.4999999995, 2720644.9, 2726640.9, 2732643.5, 2738652.6999999997, 2744668.4999999995, 2750690.9, 2756719.9, 2762755.5, 2768797.6999999997, 2774846.4999999995, 2780901.9, 2786963.9, 2793032.5, 2799107.6999999997, 2805189.4999999995, 2811277.9, 2817372.9, 2823474.5, 2829582.6999999997, 2835697.4999999995, 2841818.9, 2847946.9, 2854081.5, 2860222.6999999997, 2866370.4999999995, 2872524.9, 2878685.9, 2884853.5, 2891027.6999999997, 2897208.4999999995, 2903395.9, 2909589.9, 2915790.5, 2921997.6999999997, 2928211.4999999995, 2934431.9, 2940658.9, 2946892.5, 2953132.6999999997, 2959379.4999999995, 2965632.9, 2971892.9, 2978159.5, 2984432.6999999997, 2990712.4999999995, 2996998.9, 3003291.9, 3009591.5, 3015897.6999999997, 3022210.4999999995, 3028529.9, 3034855.9, 3041188.5, 3047527.6999999997, 3053873.4999999995, 3060225.9, 3066584.9, 3072950.5, 3079322.6999999997, 3085701.4999999995, 3092086.9, 3098478.9, 3104877.5, 3111282.6999999997, 3117694.4999999995, 3124112.9, 3130537.9, 3136969.5, 3143407.6999999997, 3149852.4999999995, 3156303.9, 3162761.9, 3169226.5, 3175697.6999999997, 3182175.4999999995, 3188659.9, 3195150.9, 3201648.5, 3208152.6999999997, 3214663.4999999995, 3221180.9, 3227704.9, 3234235.5, 3240772.6999999997, 3247316.4999999995, 3253866.9, 3260423.9, 3266987.5, 3273557.6999999997, 3280134.4999999995, 3286717.9, 3293307.9 };

        public TestIProjectedDifferentiableBaseObjective(int DebugLevel):base(DebugLevel)
        {
            
        }

        public override double[] InitParameters()
        {
            _Projection = new BoundsProjection(-6, 10);
            Random r = new Random();
            double[] parameters = new double[3];
            parameters[0] = r.Next(100);
            parameters[1] = r.Next(100);
            parameters[2] = r.Next(100);
            _Projection.Project(parameters);
            return parameters;
        }

       public override double ValueAt(double[] parameters) {
            double value = 0;
            for (int i = 0; i < data.Length; i++)
            {
                double[] datapiece = new double[] { i + 1, data[i] };
                double tmp = parameters[0] + parameters[1] * datapiece[0] + parameters[2] * Math.Pow(datapiece[0], 2);
                value += 0.5 * Math.Pow(datapiece[1] - tmp, 2);
            }
            return value;
        }


       public override double[] GradientAt(double[] parameters)
        {
            double[] gradient=new double[parameters.Length];
            for (int i = 0; i < data.Length; i++)
            {
                double[] datapiece = new double[] { i + 1, data[i] };
                double tmp = _Parameters[0] + _Parameters[1] * datapiece[0] + _Parameters[2] * Math.Pow(datapiece[0], 2);
                gradient[0] += (tmp - datapiece[1]) * 1;
                gradient[1] += (tmp - datapiece[1]) * Math.Pow(datapiece[0], 1);
                gradient[2] += (tmp - datapiece[1]) * Math.Pow(datapiece[0], 2);
            }
            return gradient;
        }

    }


    /**
   * 
   * 多项式回归
   * 
   **/
    public class TestIStochasticDifferentiableBaseObjective : AbstractStochasticDifferentiableBaseObjective
    { 
    double[] data = new double[] { 4.5, 7.699999999999999, 17.5, 33.9, 56.9, 86.5, 122.69999999999999, 165.5, 214.9, 270.9, 333.49999999999994, 402.7, 478.49999999999994, 560.9, 649.9, 745.5, 847.6999999999999, 956.5, 1071.8999999999999, 1193.9, 1322.5, 1457.6999999999998, 1599.4999999999998, 1747.8999999999999, 1902.9, 2064.4999999999995, 2232.7, 2407.5, 2588.8999999999996, 2776.9, 2971.4999999999995, 3172.7, 3380.5, 3594.8999999999996, 3815.9, 4043.5, 4277.7, 4518.5, 4765.900000000001, 5019.9, 5280.499999999999, 5547.7, 5821.5, 6101.9, 6388.9, 6682.499999999999, 6982.7, 7289.5, 7602.9, 7922.9, 8249.5, 8582.699999999999, 8922.499999999998, 9268.9, 9621.9, 9981.5, 10347.699999999999, 10720.499999999998, 11099.9, 11485.9, 11878.5, 12277.699999999999, 12683.499999999998, 13095.9, 13514.9, 13940.5, 14372.699999999999, 14811.499999999998, 15256.9, 15708.9, 16167.5, 16632.7, 17104.5, 17582.899999999998, 18067.9, 18559.5, 19057.7, 19562.5, 20073.899999999998, 20591.9, 21116.5, 21647.699999999997, 22185.499999999996, 22729.899999999998, 23280.9, 23838.5, 24402.699999999997, 24973.499999999996, 25550.899999999998, 26134.9, 26725.5, 27322.699999999997, 27926.499999999996, 28536.899999999998, 29153.9, 29777.5, 30407.699999999997, 31044.499999999996, 31687.899999999998, 32337.9, 32994.49999999999, 33657.7, 34327.5, 35003.899999999994, 35686.9, 36376.49999999999, 37072.7, 37775.5, 38484.899999999994, 39200.9, 39923.49999999999, 40652.7, 41388.5, 42130.899999999994, 42879.9, 43635.49999999999, 44397.7, 45166.5, 45941.899999999994, 46723.9, 47512.49999999999, 48307.7, 49109.5, 49917.899999999994, 50732.9, 51554.49999999999, 52382.7, 53217.5, 54058.899999999994, 54906.9, 55761.49999999999, 56622.7, 57490.5, 58364.899999999994, 59245.9, 60133.49999999999, 61027.7, 61928.5, 62835.899999999994, 63749.9, 64670.5, 65597.7, 66531.5, 67471.90000000001, 68418.9, 69372.5, 70332.7, 71299.5, 72272.90000000001, 73252.9, 74239.5, 75232.7, 76232.5, 77238.90000000001, 78251.9, 79271.5, 80297.7, 81330.5, 82369.9, 83415.9, 84468.49999999999, 85527.7, 86593.5, 87665.9, 88744.9, 89830.49999999999, 90922.7, 92021.5, 93126.9, 94238.9, 95357.49999999999, 96482.7, 97614.5, 98752.9, 99897.9, 101049.49999999999, 102207.7, 103372.5, 104543.9, 105721.9, 106906.49999999999, 108097.7, 109295.5, 110499.9, 111710.9, 112928.49999999999, 114152.7, 115383.5, 116620.9, 117864.9, 119115.49999999999, 120372.7, 121636.5, 122906.9, 124183.9, 125467.49999999999, 126757.7, 128054.5, 129357.9, 130667.9, 131984.5, 133307.69999999998, 134637.49999999997, 135973.9, 137316.9, 138666.5, 140022.69999999998, 141385.49999999997, 142754.9, 144130.9, 145513.5, 146902.69999999998, 148298.49999999997, 149700.9, 151109.9, 152525.5, 153947.69999999998, 155376.49999999997, 156811.9, 158253.9, 159702.5, 161157.69999999998, 162619.49999999997, 164087.9, 165562.9, 167044.5, 168532.69999999998, 170027.49999999997, 171528.9, 173036.9, 174551.5, 176072.69999999998, 177600.49999999997, 179134.9, 180675.9, 182223.5, 183777.69999999998, 185338.49999999997, 186905.9, 188479.9, 190060.5, 191647.69999999998, 193241.49999999997, 194841.9, 196448.9, 198062.5, 199682.69999999998, 201309.49999999997, 202942.9, 204582.9, 206229.5, 207882.69999999998, 209542.49999999997, 211208.9, 212881.9, 214561.5, 216247.69999999998, 217940.49999999997, 219639.9, 221345.9, 223058.5, 224777.69999999998, 226503.49999999997, 228235.9, 229974.9, 231720.5, 233472.69999999998, 235231.49999999997, 236996.9, 238768.9, 240547.5, 242332.69999999998, 244124.49999999997, 245922.9, 247727.9, 249539.5, 251357.69999999998, 253182.49999999997, 255013.9, 256851.9, 258696.5, 260547.7, 262405.5, 264269.89999999997, 266140.9, 268018.5, 269902.7, 271793.5, 273690.89999999997, 275594.9, 277505.5, 279422.7, 281346.5, 283276.89999999997, 285213.9, 287157.5, 289107.7, 291064.5, 293027.89999999997, 294997.9, 296974.5, 298957.7, 300947.5, 302943.89999999997, 304946.9, 306956.5, 308972.7, 310995.5, 313024.89999999997, 315060.9, 317103.5, 319152.7, 321208.5, 323270.89999999997, 325339.9, 327415.5, 329497.69999999995, 331586.49999999994, 333681.89999999997, 335783.9, 337892.5, 340007.69999999995, 342129.49999999994, 344257.89999999997, 346392.9, 348534.5, 350682.69999999995, 352837.49999999994, 354998.89999999997, 357166.9, 359341.5, 361522.69999999995, 363710.49999999994, 365904.89999999997, 368105.9, 370313.5, 372527.69999999995, 374748.49999999994, 376975.89999999997, 379209.9, 381450.5, 383697.69999999995, 385951.49999999994, 388211.89999999997, 390478.9, 392752.5, 395032.69999999995, 397319.49999999994, 399612.89999999997, 401912.9, 404219.5, 406532.69999999995, 408852.49999999994, 411178.89999999997, 413511.9, 415851.5, 418197.69999999995, 420550.49999999994, 422909.89999999997, 425275.9, 427648.5, 430027.69999999995, 432413.49999999994, 434805.89999999997, 437204.9, 439610.5, 442022.69999999995, 444441.49999999994, 446866.89999999997, 449298.9, 451737.5, 454182.69999999995, 456634.49999999994, 459092.89999999997, 461557.9, 464029.5, 466507.69999999995, 468992.49999999994, 471483.89999999997, 473981.9, 476486.5, 478997.69999999995, 481515.49999999994, 484039.89999999997, 486570.9, 489108.5, 491652.69999999995, 494203.49999999994, 496760.89999999997, 499324.9, 501895.5, 504472.69999999995, 507056.49999999994, 509646.89999999997, 512243.9, 514847.5, 517457.69999999995, 520074.49999999994, 522697.8999999999, 525327.9, 527964.4999999999, 530607.7, 533257.5, 535913.8999999999, 538576.9, 541246.4999999999, 543922.7, 546605.5, 549294.8999999999, 551990.9, 554693.4999999999, 557402.7, 560118.5, 562840.8999999999, 565569.9, 568305.4999999999, 571047.7, 573796.5, 576551.8999999999, 579313.9, 582082.4999999999, 584857.7, 587639.5, 590427.8999999999, 593222.9, 596024.4999999999, 598832.7, 601647.5, 604468.8999999999, 607296.9, 610131.4999999999, 612972.7, 615820.5, 618674.8999999999, 621535.9, 624403.4999999999, 627277.7, 630158.5, 633045.8999999999, 635939.9, 638840.4999999999, 641747.7, 644661.5, 647581.8999999999, 650508.9, 653442.4999999999, 656382.7, 659329.5, 662282.8999999999, 665242.9, 668209.4999999999, 671182.7, 674162.5, 677148.8999999999, 680141.9, 683141.4999999999, 686147.7, 689160.5, 692179.8999999999, 695205.9, 698238.4999999999, 701277.7, 704323.5, 707375.8999999999, 710434.9, 713500.4999999999, 716572.7, 719651.5, 722736.8999999999, 725828.9, 728927.4999999999, 732032.7, 735144.5, 738262.8999999999, 741387.9, 744519.4999999999, 747657.7, 750802.5, 753953.8999999999, 757111.9, 760276.4999999999, 763447.7, 766625.5, 769809.8999999999, 773000.9, 776198.4999999999, 779402.7, 782613.5, 785830.8999999999, 789054.9, 792285.4999999999, 795522.7, 798766.5, 802016.8999999999, 805273.9, 808537.4999999999, 811807.7, 815084.5, 818367.8999999999, 821657.9, 824954.4999999999, 828257.7, 831567.5, 834883.8999999999, 838206.9, 841536.4999999999, 844872.7, 848215.5, 851564.8999999999, 854920.9, 858283.4999999999, 861652.7, 865028.5, 868410.8999999999, 871799.9, 875195.4999999999, 878597.7, 882006.5, 885421.8999999999, 888843.9, 892272.4999999999, 895707.7, 899149.5, 902597.8999999999, 906052.9, 909514.4999999999, 912982.7, 916457.5, 919938.8999999999, 923426.9, 926921.4999999999, 930422.7, 933930.5, 937444.8999999999, 940965.9, 944493.4999999999, 948027.7, 951568.5, 955115.8999999999, 958669.9, 962230.4999999999, 965797.7, 969371.5, 972951.8999999999, 976538.9, 980132.4999999999, 983732.7, 987339.5, 990952.8999999999, 994572.9, 998199.4999999999, 1001832.7, 1005472.5, 1009118.8999999999, 1012771.9, 1016431.4999999999, 1020097.7, 1023770.5, 1027449.8999999999, 1031135.9, 1034828.4999999999, 1038527.7, 1042233.5, 1045945.9, 1049664.9, 1053390.5, 1057122.7, 1060861.5, 1064606.9000000001, 1068358.9, 1072117.5, 1075882.7, 1079654.5, 1083432.9000000001, 1087217.9, 1091009.5, 1094807.7, 1098612.5, 1102423.9000000001, 1106241.9, 1110066.5, 1113897.7, 1117735.5, 1121579.9000000001, 1125430.9, 1129288.5, 1133152.7, 1137023.5, 1140900.9000000001, 1144784.9, 1148675.5, 1152572.7, 1156476.5, 1160386.9000000001, 1164303.9, 1168227.5, 1172157.7, 1176094.5, 1180037.9000000001, 1183987.9, 1187944.5, 1191907.7, 1195877.5, 1199853.9000000001, 1203836.9, 1207826.5, 1211822.7, 1215825.5, 1219834.9000000001, 1223850.9, 1227873.5, 1231902.7, 1235938.5, 1239980.9000000001, 1244029.9, 1248085.5, 1252147.7, 1256216.5, 1260291.9000000001, 1264373.9, 1268462.5, 1272557.7, 1276659.5, 1280767.9000000001, 1284882.9, 1289004.5, 1293132.7, 1297267.5, 1301408.9, 1305556.9, 1309711.4999999998, 1313872.7, 1318040.5, 1322214.9, 1326395.9, 1330583.4999999998, 1334777.7, 1338978.5, 1343185.9, 1347399.9, 1351620.4999999998, 1355847.7, 1360081.5, 1364321.9, 1368568.9, 1372822.4999999998, 1377082.7, 1381349.5, 1385622.9, 1389902.9, 1394189.4999999998, 1398482.7, 1402782.5, 1407088.9, 1411401.9, 1415721.4999999998, 1420047.7, 1424380.5, 1428719.9, 1433065.9, 1437418.4999999998, 1441777.7, 1446143.5, 1450515.9, 1454894.9, 1459280.4999999998, 1463672.7, 1468071.5, 1472476.9, 1476888.9, 1481307.4999999998, 1485732.7, 1490164.5, 1494602.9, 1499047.9, 1503499.4999999998, 1507957.7, 1512422.5, 1516893.9, 1521371.9, 1525856.4999999998, 1530347.7, 1534845.5, 1539349.9, 1543860.9, 1548378.4999999998, 1552902.7, 1557433.5, 1561970.9, 1566514.9, 1571065.4999999998, 1575622.7, 1580186.5, 1584756.9, 1589333.9, 1593917.4999999998, 1598507.7, 1603104.5, 1607707.9, 1612317.9, 1616934.4999999998, 1621557.7, 1626187.5, 1630823.9, 1635466.9, 1640116.4999999998, 1644772.7, 1649435.5, 1654104.9, 1658780.9, 1663463.4999999998, 1668152.7, 1672848.5, 1677550.9, 1682259.9, 1686975.4999999998, 1691697.7, 1696426.5, 1701161.9, 1705903.9, 1710652.4999999998, 1715407.7, 1720169.5, 1724937.9, 1729712.9, 1734494.4999999998, 1739282.7, 1744077.5, 1748878.9, 1753686.9, 1758501.4999999998, 1763322.7, 1768150.5, 1772984.9, 1777825.9, 1782673.4999999998, 1787527.7, 1792388.5, 1797255.9, 1802129.9, 1807010.4999999998, 1811897.7, 1816791.5, 1821691.9, 1826598.9, 1831512.4999999998, 1836432.7, 1841359.5, 1846292.9, 1851232.9, 1856179.4999999998, 1861132.7, 1866092.5, 1871058.9, 1876031.9, 1881011.4999999998, 1885997.7, 1890990.5, 1895989.9, 1900995.9, 1906008.4999999998, 1911027.7, 1916053.5, 1921085.9, 1926124.9, 1931170.4999999998, 1936222.7, 1941281.5, 1946346.9, 1951418.9, 1956497.4999999998, 1961582.7, 1966674.5, 1971772.9, 1976877.9, 1981989.4999999998, 1987107.7, 1992232.5, 1997363.9, 2002501.9, 2007646.4999999998, 2012797.7, 2017955.5, 2023119.9, 2028290.9, 2033468.4999999998, 2038652.7, 2043843.5, 2049040.9, 2054244.9, 2059455.4999999998, 2064672.7, 2069896.5, 2075126.9, 2080363.9, 2085607.4999999998, 2090857.7, 2096114.4999999998, 2101377.9, 2106647.9, 2111924.5, 2117207.6999999997, 2122497.4999999995, 2127793.9, 2133096.9, 2138406.5, 2143722.6999999997, 2149045.4999999995, 2154374.9, 2159710.9, 2165053.5, 2170402.6999999997, 2175758.4999999995, 2181120.9, 2186489.9, 2191865.5, 2197247.6999999997, 2202636.4999999995, 2208031.9, 2213433.9, 2218842.5, 2224257.6999999997, 2229679.4999999995, 2235107.9, 2240542.9, 2245984.5, 2251432.6999999997, 2256887.4999999995, 2262348.9, 2267816.9, 2273291.5, 2278772.6999999997, 2284260.4999999995, 2289754.9, 2295255.9, 2300763.5, 2306277.6999999997, 2311798.4999999995, 2317325.9, 2322859.9, 2328400.5, 2333947.6999999997, 2339501.4999999995, 2345061.9, 2350628.9, 2356202.5, 2361782.6999999997, 2367369.4999999995, 2372962.9, 2378562.9, 2384169.5, 2389782.6999999997, 2395402.4999999995, 2401028.9, 2406661.9, 2412301.5, 2417947.6999999997, 2423600.4999999995, 2429259.9, 2434925.9, 2440598.5, 2446277.6999999997, 2451963.4999999995, 2457655.9, 2463354.9, 2469060.5, 2474772.6999999997, 2480491.4999999995, 2486216.9, 2491948.9, 2497687.5, 2503432.6999999997, 2509184.4999999995, 2514942.9, 2520707.9, 2526479.5, 2532257.6999999997, 2538042.4999999995, 2543833.9, 2549631.9, 2555436.5, 2561247.6999999997, 2567065.4999999995, 2572889.9, 2578720.9, 2584558.5, 2590402.6999999997, 2596253.4999999995, 2602110.9, 2607974.9, 2613845.5, 2619722.6999999997, 2625606.4999999995, 2631496.9, 2637393.9, 2643297.5, 2649207.6999999997, 2655124.4999999995, 2661047.9, 2666977.9, 2672914.5, 2678857.6999999997, 2684807.4999999995, 2690763.9, 2696726.9, 2702696.5, 2708672.6999999997, 2714655.4999999995, 2720644.9, 2726640.9, 2732643.5, 2738652.6999999997, 2744668.4999999995, 2750690.9, 2756719.9, 2762755.5, 2768797.6999999997, 2774846.4999999995, 2780901.9, 2786963.9, 2793032.5, 2799107.6999999997, 2805189.4999999995, 2811277.9, 2817372.9, 2823474.5, 2829582.6999999997, 2835697.4999999995, 2841818.9, 2847946.9, 2854081.5, 2860222.6999999997, 2866370.4999999995, 2872524.9, 2878685.9, 2884853.5, 2891027.6999999997, 2897208.4999999995, 2903395.9, 2909589.9, 2915790.5, 2921997.6999999997, 2928211.4999999995, 2934431.9, 2940658.9, 2946892.5, 2953132.6999999997, 2959379.4999999995, 2965632.9, 2971892.9, 2978159.5, 2984432.6999999997, 2990712.4999999995, 2996998.9, 3003291.9, 3009591.5, 3015897.6999999997, 3022210.4999999995, 3028529.9, 3034855.9, 3041188.5, 3047527.6999999997, 3053873.4999999995, 3060225.9, 3066584.9, 3072950.5, 3079322.6999999997, 3085701.4999999995, 3092086.9, 3098478.9, 3104877.5, 3111282.6999999997, 3117694.4999999995, 3124112.9, 3130537.9, 3136969.5, 3143407.6999999997, 3149852.4999999995, 3156303.9, 3162761.9, 3169226.5, 3175697.6999999997, 3182175.4999999995, 3188659.9, 3195150.9, 3201648.5, 3208152.6999999997, 3214663.4999999995, 3221180.9, 3227704.9, 3234235.5, 3240772.6999999997, 3247316.4999999995, 3253866.9, 3260423.9, 3266987.5, 3273557.6999999997, 3280134.4999999995, 3286717.9, 3293307.9 };

        public TestIStochasticDifferentiableBaseObjective(int DebugLevel):base(DebugLevel)
        {
        }

        public override double[] InitParameters()
        {
            Random r = new Random();
            double[] parameters = new double[3];
            parameters[0] = r.Next(100);
            parameters[1] = r.Next(100);
            parameters[2] = r.Next(100);
            return parameters;
        }


       public override int DatasetSize() {
            return data.Length;
        }


        private int i = 0;
       public override void NextDataSample() {
            _CurrentDataSample = new double[2] { i % data.Length + 1, data[i % data.Length] };
            i++;
        }

       public override double ValueAt(double[] parameters,double[] datasample) {
            double value = 0;

            double tmp = parameters[0] + parameters[1] * datasample[0] + parameters[2] * Math.Pow(datasample[0], 2);
            value += 0.5 * Math.Pow(datasample[1] - tmp, 2);
            return value;
        }

       public override double[] GradientAt(double[] parameters,double[] datasample) {

            double[] gradient=new double[parameters.Length];

            double tmp = parameters[0] + parameters[1] * datasample[0] + parameters[2] * Math.Pow(datasample[0], 2);
            gradient[0] += (tmp - datasample[1]) * 1;
            gradient[1] += (tmp - datasample[1]) * Math.Pow(datasample[0], 1);
            gradient[2] += (tmp - datasample[1]) * Math.Pow(datasample[0], 2);

            return gradient;
        }

    }


    /**
   * 
   * 多项式回归
   * 
   **/
    public class TestIProjectedStochasticDifferentiableBaseObjective : AbstractProjectedStochasticDifferentiableBaseObjective { 
    
    double[] data = new double[] { 4.5, 7.699999999999999, 17.5, 33.9, 56.9, 86.5, 122.69999999999999, 165.5, 214.9, 270.9, 333.49999999999994, 402.7, 478.49999999999994, 560.9, 649.9, 745.5, 847.6999999999999, 956.5, 1071.8999999999999, 1193.9, 1322.5, 1457.6999999999998, 1599.4999999999998, 1747.8999999999999, 1902.9, 2064.4999999999995, 2232.7, 2407.5, 2588.8999999999996, 2776.9, 2971.4999999999995, 3172.7, 3380.5, 3594.8999999999996, 3815.9, 4043.5, 4277.7, 4518.5, 4765.900000000001, 5019.9, 5280.499999999999, 5547.7, 5821.5, 6101.9, 6388.9, 6682.499999999999, 6982.7, 7289.5, 7602.9, 7922.9, 8249.5, 8582.699999999999, 8922.499999999998, 9268.9, 9621.9, 9981.5, 10347.699999999999, 10720.499999999998, 11099.9, 11485.9, 11878.5, 12277.699999999999, 12683.499999999998, 13095.9, 13514.9, 13940.5, 14372.699999999999, 14811.499999999998, 15256.9, 15708.9, 16167.5, 16632.7, 17104.5, 17582.899999999998, 18067.9, 18559.5, 19057.7, 19562.5, 20073.899999999998, 20591.9, 21116.5, 21647.699999999997, 22185.499999999996, 22729.899999999998, 23280.9, 23838.5, 24402.699999999997, 24973.499999999996, 25550.899999999998, 26134.9, 26725.5, 27322.699999999997, 27926.499999999996, 28536.899999999998, 29153.9, 29777.5, 30407.699999999997, 31044.499999999996, 31687.899999999998, 32337.9, 32994.49999999999, 33657.7, 34327.5, 35003.899999999994, 35686.9, 36376.49999999999, 37072.7, 37775.5, 38484.899999999994, 39200.9, 39923.49999999999, 40652.7, 41388.5, 42130.899999999994, 42879.9, 43635.49999999999, 44397.7, 45166.5, 45941.899999999994, 46723.9, 47512.49999999999, 48307.7, 49109.5, 49917.899999999994, 50732.9, 51554.49999999999, 52382.7, 53217.5, 54058.899999999994, 54906.9, 55761.49999999999, 56622.7, 57490.5, 58364.899999999994, 59245.9, 60133.49999999999, 61027.7, 61928.5, 62835.899999999994, 63749.9, 64670.5, 65597.7, 66531.5, 67471.90000000001, 68418.9, 69372.5, 70332.7, 71299.5, 72272.90000000001, 73252.9, 74239.5, 75232.7, 76232.5, 77238.90000000001, 78251.9, 79271.5, 80297.7, 81330.5, 82369.9, 83415.9, 84468.49999999999, 85527.7, 86593.5, 87665.9, 88744.9, 89830.49999999999, 90922.7, 92021.5, 93126.9, 94238.9, 95357.49999999999, 96482.7, 97614.5, 98752.9, 99897.9, 101049.49999999999, 102207.7, 103372.5, 104543.9, 105721.9, 106906.49999999999, 108097.7, 109295.5, 110499.9, 111710.9, 112928.49999999999, 114152.7, 115383.5, 116620.9, 117864.9, 119115.49999999999, 120372.7, 121636.5, 122906.9, 124183.9, 125467.49999999999, 126757.7, 128054.5, 129357.9, 130667.9, 131984.5, 133307.69999999998, 134637.49999999997, 135973.9, 137316.9, 138666.5, 140022.69999999998, 141385.49999999997, 142754.9, 144130.9, 145513.5, 146902.69999999998, 148298.49999999997, 149700.9, 151109.9, 152525.5, 153947.69999999998, 155376.49999999997, 156811.9, 158253.9, 159702.5, 161157.69999999998, 162619.49999999997, 164087.9, 165562.9, 167044.5, 168532.69999999998, 170027.49999999997, 171528.9, 173036.9, 174551.5, 176072.69999999998, 177600.49999999997, 179134.9, 180675.9, 182223.5, 183777.69999999998, 185338.49999999997, 186905.9, 188479.9, 190060.5, 191647.69999999998, 193241.49999999997, 194841.9, 196448.9, 198062.5, 199682.69999999998, 201309.49999999997, 202942.9, 204582.9, 206229.5, 207882.69999999998, 209542.49999999997, 211208.9, 212881.9, 214561.5, 216247.69999999998, 217940.49999999997, 219639.9, 221345.9, 223058.5, 224777.69999999998, 226503.49999999997, 228235.9, 229974.9, 231720.5, 233472.69999999998, 235231.49999999997, 236996.9, 238768.9, 240547.5, 242332.69999999998, 244124.49999999997, 245922.9, 247727.9, 249539.5, 251357.69999999998, 253182.49999999997, 255013.9, 256851.9, 258696.5, 260547.7, 262405.5, 264269.89999999997, 266140.9, 268018.5, 269902.7, 271793.5, 273690.89999999997, 275594.9, 277505.5, 279422.7, 281346.5, 283276.89999999997, 285213.9, 287157.5, 289107.7, 291064.5, 293027.89999999997, 294997.9, 296974.5, 298957.7, 300947.5, 302943.89999999997, 304946.9, 306956.5, 308972.7, 310995.5, 313024.89999999997, 315060.9, 317103.5, 319152.7, 321208.5, 323270.89999999997, 325339.9, 327415.5, 329497.69999999995, 331586.49999999994, 333681.89999999997, 335783.9, 337892.5, 340007.69999999995, 342129.49999999994, 344257.89999999997, 346392.9, 348534.5, 350682.69999999995, 352837.49999999994, 354998.89999999997, 357166.9, 359341.5, 361522.69999999995, 363710.49999999994, 365904.89999999997, 368105.9, 370313.5, 372527.69999999995, 374748.49999999994, 376975.89999999997, 379209.9, 381450.5, 383697.69999999995, 385951.49999999994, 388211.89999999997, 390478.9, 392752.5, 395032.69999999995, 397319.49999999994, 399612.89999999997, 401912.9, 404219.5, 406532.69999999995, 408852.49999999994, 411178.89999999997, 413511.9, 415851.5, 418197.69999999995, 420550.49999999994, 422909.89999999997, 425275.9, 427648.5, 430027.69999999995, 432413.49999999994, 434805.89999999997, 437204.9, 439610.5, 442022.69999999995, 444441.49999999994, 446866.89999999997, 449298.9, 451737.5, 454182.69999999995, 456634.49999999994, 459092.89999999997, 461557.9, 464029.5, 466507.69999999995, 468992.49999999994, 471483.89999999997, 473981.9, 476486.5, 478997.69999999995, 481515.49999999994, 484039.89999999997, 486570.9, 489108.5, 491652.69999999995, 494203.49999999994, 496760.89999999997, 499324.9, 501895.5, 504472.69999999995, 507056.49999999994, 509646.89999999997, 512243.9, 514847.5, 517457.69999999995, 520074.49999999994, 522697.8999999999, 525327.9, 527964.4999999999, 530607.7, 533257.5, 535913.8999999999, 538576.9, 541246.4999999999, 543922.7, 546605.5, 549294.8999999999, 551990.9, 554693.4999999999, 557402.7, 560118.5, 562840.8999999999, 565569.9, 568305.4999999999, 571047.7, 573796.5, 576551.8999999999, 579313.9, 582082.4999999999, 584857.7, 587639.5, 590427.8999999999, 593222.9, 596024.4999999999, 598832.7, 601647.5, 604468.8999999999, 607296.9, 610131.4999999999, 612972.7, 615820.5, 618674.8999999999, 621535.9, 624403.4999999999, 627277.7, 630158.5, 633045.8999999999, 635939.9, 638840.4999999999, 641747.7, 644661.5, 647581.8999999999, 650508.9, 653442.4999999999, 656382.7, 659329.5, 662282.8999999999, 665242.9, 668209.4999999999, 671182.7, 674162.5, 677148.8999999999, 680141.9, 683141.4999999999, 686147.7, 689160.5, 692179.8999999999, 695205.9, 698238.4999999999, 701277.7, 704323.5, 707375.8999999999, 710434.9, 713500.4999999999, 716572.7, 719651.5, 722736.8999999999, 725828.9, 728927.4999999999, 732032.7, 735144.5, 738262.8999999999, 741387.9, 744519.4999999999, 747657.7, 750802.5, 753953.8999999999, 757111.9, 760276.4999999999, 763447.7, 766625.5, 769809.8999999999, 773000.9, 776198.4999999999, 779402.7, 782613.5, 785830.8999999999, 789054.9, 792285.4999999999, 795522.7, 798766.5, 802016.8999999999, 805273.9, 808537.4999999999, 811807.7, 815084.5, 818367.8999999999, 821657.9, 824954.4999999999, 828257.7, 831567.5, 834883.8999999999, 838206.9, 841536.4999999999, 844872.7, 848215.5, 851564.8999999999, 854920.9, 858283.4999999999, 861652.7, 865028.5, 868410.8999999999, 871799.9, 875195.4999999999, 878597.7, 882006.5, 885421.8999999999, 888843.9, 892272.4999999999, 895707.7, 899149.5, 902597.8999999999, 906052.9, 909514.4999999999, 912982.7, 916457.5, 919938.8999999999, 923426.9, 926921.4999999999, 930422.7, 933930.5, 937444.8999999999, 940965.9, 944493.4999999999, 948027.7, 951568.5, 955115.8999999999, 958669.9, 962230.4999999999, 965797.7, 969371.5, 972951.8999999999, 976538.9, 980132.4999999999, 983732.7, 987339.5, 990952.8999999999, 994572.9, 998199.4999999999, 1001832.7, 1005472.5, 1009118.8999999999, 1012771.9, 1016431.4999999999, 1020097.7, 1023770.5, 1027449.8999999999, 1031135.9, 1034828.4999999999, 1038527.7, 1042233.5, 1045945.9, 1049664.9, 1053390.5, 1057122.7, 1060861.5, 1064606.9000000001, 1068358.9, 1072117.5, 1075882.7, 1079654.5, 1083432.9000000001, 1087217.9, 1091009.5, 1094807.7, 1098612.5, 1102423.9000000001, 1106241.9, 1110066.5, 1113897.7, 1117735.5, 1121579.9000000001, 1125430.9, 1129288.5, 1133152.7, 1137023.5, 1140900.9000000001, 1144784.9, 1148675.5, 1152572.7, 1156476.5, 1160386.9000000001, 1164303.9, 1168227.5, 1172157.7, 1176094.5, 1180037.9000000001, 1183987.9, 1187944.5, 1191907.7, 1195877.5, 1199853.9000000001, 1203836.9, 1207826.5, 1211822.7, 1215825.5, 1219834.9000000001, 1223850.9, 1227873.5, 1231902.7, 1235938.5, 1239980.9000000001, 1244029.9, 1248085.5, 1252147.7, 1256216.5, 1260291.9000000001, 1264373.9, 1268462.5, 1272557.7, 1276659.5, 1280767.9000000001, 1284882.9, 1289004.5, 1293132.7, 1297267.5, 1301408.9, 1305556.9, 1309711.4999999998, 1313872.7, 1318040.5, 1322214.9, 1326395.9, 1330583.4999999998, 1334777.7, 1338978.5, 1343185.9, 1347399.9, 1351620.4999999998, 1355847.7, 1360081.5, 1364321.9, 1368568.9, 1372822.4999999998, 1377082.7, 1381349.5, 1385622.9, 1389902.9, 1394189.4999999998, 1398482.7, 1402782.5, 1407088.9, 1411401.9, 1415721.4999999998, 1420047.7, 1424380.5, 1428719.9, 1433065.9, 1437418.4999999998, 1441777.7, 1446143.5, 1450515.9, 1454894.9, 1459280.4999999998, 1463672.7, 1468071.5, 1472476.9, 1476888.9, 1481307.4999999998, 1485732.7, 1490164.5, 1494602.9, 1499047.9, 1503499.4999999998, 1507957.7, 1512422.5, 1516893.9, 1521371.9, 1525856.4999999998, 1530347.7, 1534845.5, 1539349.9, 1543860.9, 1548378.4999999998, 1552902.7, 1557433.5, 1561970.9, 1566514.9, 1571065.4999999998, 1575622.7, 1580186.5, 1584756.9, 1589333.9, 1593917.4999999998, 1598507.7, 1603104.5, 1607707.9, 1612317.9, 1616934.4999999998, 1621557.7, 1626187.5, 1630823.9, 1635466.9, 1640116.4999999998, 1644772.7, 1649435.5, 1654104.9, 1658780.9, 1663463.4999999998, 1668152.7, 1672848.5, 1677550.9, 1682259.9, 1686975.4999999998, 1691697.7, 1696426.5, 1701161.9, 1705903.9, 1710652.4999999998, 1715407.7, 1720169.5, 1724937.9, 1729712.9, 1734494.4999999998, 1739282.7, 1744077.5, 1748878.9, 1753686.9, 1758501.4999999998, 1763322.7, 1768150.5, 1772984.9, 1777825.9, 1782673.4999999998, 1787527.7, 1792388.5, 1797255.9, 1802129.9, 1807010.4999999998, 1811897.7, 1816791.5, 1821691.9, 1826598.9, 1831512.4999999998, 1836432.7, 1841359.5, 1846292.9, 1851232.9, 1856179.4999999998, 1861132.7, 1866092.5, 1871058.9, 1876031.9, 1881011.4999999998, 1885997.7, 1890990.5, 1895989.9, 1900995.9, 1906008.4999999998, 1911027.7, 1916053.5, 1921085.9, 1926124.9, 1931170.4999999998, 1936222.7, 1941281.5, 1946346.9, 1951418.9, 1956497.4999999998, 1961582.7, 1966674.5, 1971772.9, 1976877.9, 1981989.4999999998, 1987107.7, 1992232.5, 1997363.9, 2002501.9, 2007646.4999999998, 2012797.7, 2017955.5, 2023119.9, 2028290.9, 2033468.4999999998, 2038652.7, 2043843.5, 2049040.9, 2054244.9, 2059455.4999999998, 2064672.7, 2069896.5, 2075126.9, 2080363.9, 2085607.4999999998, 2090857.7, 2096114.4999999998, 2101377.9, 2106647.9, 2111924.5, 2117207.6999999997, 2122497.4999999995, 2127793.9, 2133096.9, 2138406.5, 2143722.6999999997, 2149045.4999999995, 2154374.9, 2159710.9, 2165053.5, 2170402.6999999997, 2175758.4999999995, 2181120.9, 2186489.9, 2191865.5, 2197247.6999999997, 2202636.4999999995, 2208031.9, 2213433.9, 2218842.5, 2224257.6999999997, 2229679.4999999995, 2235107.9, 2240542.9, 2245984.5, 2251432.6999999997, 2256887.4999999995, 2262348.9, 2267816.9, 2273291.5, 2278772.6999999997, 2284260.4999999995, 2289754.9, 2295255.9, 2300763.5, 2306277.6999999997, 2311798.4999999995, 2317325.9, 2322859.9, 2328400.5, 2333947.6999999997, 2339501.4999999995, 2345061.9, 2350628.9, 2356202.5, 2361782.6999999997, 2367369.4999999995, 2372962.9, 2378562.9, 2384169.5, 2389782.6999999997, 2395402.4999999995, 2401028.9, 2406661.9, 2412301.5, 2417947.6999999997, 2423600.4999999995, 2429259.9, 2434925.9, 2440598.5, 2446277.6999999997, 2451963.4999999995, 2457655.9, 2463354.9, 2469060.5, 2474772.6999999997, 2480491.4999999995, 2486216.9, 2491948.9, 2497687.5, 2503432.6999999997, 2509184.4999999995, 2514942.9, 2520707.9, 2526479.5, 2532257.6999999997, 2538042.4999999995, 2543833.9, 2549631.9, 2555436.5, 2561247.6999999997, 2567065.4999999995, 2572889.9, 2578720.9, 2584558.5, 2590402.6999999997, 2596253.4999999995, 2602110.9, 2607974.9, 2613845.5, 2619722.6999999997, 2625606.4999999995, 2631496.9, 2637393.9, 2643297.5, 2649207.6999999997, 2655124.4999999995, 2661047.9, 2666977.9, 2672914.5, 2678857.6999999997, 2684807.4999999995, 2690763.9, 2696726.9, 2702696.5, 2708672.6999999997, 2714655.4999999995, 2720644.9, 2726640.9, 2732643.5, 2738652.6999999997, 2744668.4999999995, 2750690.9, 2756719.9, 2762755.5, 2768797.6999999997, 2774846.4999999995, 2780901.9, 2786963.9, 2793032.5, 2799107.6999999997, 2805189.4999999995, 2811277.9, 2817372.9, 2823474.5, 2829582.6999999997, 2835697.4999999995, 2841818.9, 2847946.9, 2854081.5, 2860222.6999999997, 2866370.4999999995, 2872524.9, 2878685.9, 2884853.5, 2891027.6999999997, 2897208.4999999995, 2903395.9, 2909589.9, 2915790.5, 2921997.6999999997, 2928211.4999999995, 2934431.9, 2940658.9, 2946892.5, 2953132.6999999997, 2959379.4999999995, 2965632.9, 2971892.9, 2978159.5, 2984432.6999999997, 2990712.4999999995, 2996998.9, 3003291.9, 3009591.5, 3015897.6999999997, 3022210.4999999995, 3028529.9, 3034855.9, 3041188.5, 3047527.6999999997, 3053873.4999999995, 3060225.9, 3066584.9, 3072950.5, 3079322.6999999997, 3085701.4999999995, 3092086.9, 3098478.9, 3104877.5, 3111282.6999999997, 3117694.4999999995, 3124112.9, 3130537.9, 3136969.5, 3143407.6999999997, 3149852.4999999995, 3156303.9, 3162761.9, 3169226.5, 3175697.6999999997, 3182175.4999999995, 3188659.9, 3195150.9, 3201648.5, 3208152.6999999997, 3214663.4999999995, 3221180.9, 3227704.9, 3234235.5, 3240772.6999999997, 3247316.4999999995, 3253866.9, 3260423.9, 3266987.5, 3273557.6999999997, 3280134.4999999995, 3286717.9, 3293307.9 };

        public TestIProjectedStochasticDifferentiableBaseObjective(int DebugLevel):base(DebugLevel)
        {
           
        }

        public override double[] InitParameters()
        {
            _Projection = new BoundsProjection(-6, 100);
            Random r = new Random();
            double[] parameters = new double[3];
            parameters[0] = r.Next(100);
            parameters[1] = r.Next(100);
            parameters[2] = r.Next(100);
            _Projection.Project(parameters);
            return parameters;
        }

        public override int DatasetSize() {
            return data.Length;
        }


        private int i = 0;
        public override void NextDataSample()
        {
            _CurrentDataSample = new double[] { i % data.Length + 1, data[i % data.Length] };
            i++;
        }

        public override double ValueAt(double[] parameters, double[] datasample)
        {
            double value = 0;

            double tmp = parameters[0] + parameters[1] * datasample[0] + parameters[2] * Math.Pow(datasample[0], 2);
                value += 0.5 * Math.Pow(datasample[1] - tmp, 2);
                return value;
        }

        public override double[] GradientAt(double[] parameters, double[] datasample)
        {

            double[] gradient=new double[parameters.Length];

            double tmp = parameters[0] + parameters[1] * datasample[0] + parameters[2] * Math.Pow(datasample[0], 2);
                gradient[0] += (tmp - datasample[1]) * 1;
                gradient[1] += (tmp - datasample[1]) * Math.Pow(datasample[0], 1);
                gradient[2] += (tmp - datasample[1]) * Math.Pow(datasample[0], 2);

                return gradient;
        }

    }

}
